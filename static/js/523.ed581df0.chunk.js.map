{"version":3,"file":"static/js/523.ed581df0.chunk.js","mappings":"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","sources":["../node_modules/three/examples/jsm/controls/FirstPersonControls.js","pages/Demo/newSpace/index.js"],"sourcesContent":["import {\n\tMathUtils,\n\tSpherical,\n\tVector3\n} from 'three';\n\nconst _lookDirection = new Vector3();\nconst _spherical = new Spherical();\nconst _target = new Vector3();\n\nclass FirstPersonControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\n\t\tthis.movementSpeed = 1.0;\n\t\tthis.lookSpeed = 0.005;\n\n\t\tthis.lookVertical = true;\n\t\tthis.autoForward = false;\n\n\t\tthis.activeLook = true;\n\n\t\tthis.heightSpeed = false;\n\t\tthis.heightCoef = 1.0;\n\t\tthis.heightMin = 0.0;\n\t\tthis.heightMax = 1.0;\n\n\t\tthis.constrainVertical = false;\n\t\tthis.verticalMin = 0;\n\t\tthis.verticalMax = Math.PI;\n\n\t\tthis.mouseDragOn = false;\n\n\t\t// internals\n\n\t\tthis.autoSpeedFactor = 0.0;\n\n\t\tthis.pointerX = 0;\n\t\tthis.pointerY = 0;\n\n\t\tthis.moveForward = false;\n\t\tthis.moveBackward = false;\n\t\tthis.moveLeft = false;\n\t\tthis.moveRight = false;\n\n\t\tthis.viewHalfX = 0;\n\t\tthis.viewHalfY = 0;\n\n\t\t// private variables\n\n\t\tlet lat = 0;\n\t\tlet lon = 0;\n\n\t\t//\n\n\t\tthis.handleResize = function () {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.viewHalfX = window.innerWidth / 2;\n\t\t\t\tthis.viewHalfY = window.innerHeight / 2;\n\n\t\t\t} else {\n\n\t\t\t\tthis.viewHalfX = this.domElement.offsetWidth / 2;\n\t\t\t\tthis.viewHalfY = this.domElement.offsetHeight / 2;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onPointerDown = function ( event ) {\n\n\t\t\tif ( this.domElement !== document ) {\n\n\t\t\t\tthis.domElement.focus();\n\n\t\t\t}\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = true; break;\n\t\t\t\t\tcase 2: this.moveBackward = true; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = true;\n\n\t\t};\n\n\t\tthis.onPointerUp = function ( event ) {\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = false; break;\n\t\t\t\t\tcase 2: this.moveBackward = false; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = false;\n\n\t\t};\n\n\t\tthis.onPointerMove = function ( event ) {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.pointerX = event.pageX - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.viewHalfY;\n\n\t\t\t} else {\n\n\t\t\t\tthis.pointerX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.domElement.offsetTop - this.viewHalfY;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyDown = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = true; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = true; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = true; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = true; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = true; break;\n\t\t\t\tcase 'KeyF': this.moveDown = true; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyUp = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = false; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = false; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = false; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = false; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = false; break;\n\t\t\t\tcase 'KeyF': this.moveDown = false; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.lookAt = function ( x, y, z ) {\n\n\t\t\tif ( x.isVector3 ) {\n\n\t\t\t\t_target.copy( x );\n\n\t\t\t} else {\n\n\t\t\t\t_target.set( x, y, z );\n\n\t\t\t}\n\n\t\t\tthis.object.lookAt( _target );\n\n\t\t\tsetOrientation( this );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.update = function () {\n\n\t\t\tconst targetPosition = new Vector3();\n\n\t\t\treturn function update( delta ) {\n\n\t\t\t\tif ( this.enabled === false ) return;\n\n\t\t\t\tif ( this.heightSpeed ) {\n\n\t\t\t\t\tconst y = MathUtils.clamp( this.object.position.y, this.heightMin, this.heightMax );\n\t\t\t\t\tconst heightDelta = y - this.heightMin;\n\n\t\t\t\t\tthis.autoSpeedFactor = delta * ( heightDelta * this.heightCoef );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.autoSpeedFactor = 0.0;\n\n\t\t\t\t}\n\n\t\t\t\tconst actualMoveSpeed = delta * this.movementSpeed;\n\n\t\t\t\tif ( this.moveForward || ( this.autoForward && ! this.moveBackward ) ) this.object.translateZ( - ( actualMoveSpeed + this.autoSpeedFactor ) );\n\t\t\t\tif ( this.moveBackward ) this.object.translateZ( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveLeft ) this.object.translateX( - actualMoveSpeed );\n\t\t\t\tif ( this.moveRight ) this.object.translateX( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveUp ) this.object.translateY( actualMoveSpeed );\n\t\t\t\tif ( this.moveDown ) this.object.translateY( - actualMoveSpeed );\n\n\t\t\t\tlet actualLookSpeed = delta * this.lookSpeed;\n\n\t\t\t\tif ( ! this.activeLook ) {\n\n\t\t\t\t\tactualLookSpeed = 0;\n\n\t\t\t\t}\n\n\t\t\t\tlet verticalLookRatio = 1;\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tverticalLookRatio = Math.PI / ( this.verticalMax - this.verticalMin );\n\n\t\t\t\t}\n\n\t\t\t\tlon -= this.pointerX * actualLookSpeed;\n\t\t\t\tif ( this.lookVertical ) lat -= this.pointerY * actualLookSpeed * verticalLookRatio;\n\n\t\t\t\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\n\t\t\t\tlet phi = MathUtils.degToRad( 90 - lat );\n\t\t\t\tconst theta = MathUtils.degToRad( lon );\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tphi = MathUtils.mapLinear( phi, 0, Math.PI, this.verticalMin, this.verticalMax );\n\n\t\t\t\t}\n\n\t\t\t\tconst position = this.object.position;\n\n\t\t\t\ttargetPosition.setFromSphericalCoords( 1, phi, theta ).add( position );\n\n\t\t\t\tthis.object.lookAt( targetPosition );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu );\n\t\t\tthis.domElement.removeEventListener( 'pointerdown', _onPointerDown );\n\t\t\tthis.domElement.removeEventListener( 'pointermove', _onPointerMove );\n\t\t\tthis.domElement.removeEventListener( 'pointerup', _onPointerUp );\n\n\t\t\twindow.removeEventListener( 'keydown', _onKeyDown );\n\t\t\twindow.removeEventListener( 'keyup', _onKeyUp );\n\n\t\t};\n\n\t\tconst _onPointerMove = this.onPointerMove.bind( this );\n\t\tconst _onPointerDown = this.onPointerDown.bind( this );\n\t\tconst _onPointerUp = this.onPointerUp.bind( this );\n\t\tconst _onKeyDown = this.onKeyDown.bind( this );\n\t\tconst _onKeyUp = this.onKeyUp.bind( this );\n\n\t\tthis.domElement.addEventListener( 'contextmenu', contextmenu );\n\t\tthis.domElement.addEventListener( 'pointerdown', _onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointermove', _onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerup', _onPointerUp );\n\n\t\twindow.addEventListener( 'keydown', _onKeyDown );\n\t\twindow.addEventListener( 'keyup', _onKeyUp );\n\n\t\tfunction setOrientation( controls ) {\n\n\t\t\tconst quaternion = controls.object.quaternion;\n\n\t\t\t_lookDirection.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\t\t\t_spherical.setFromVector3( _lookDirection );\n\n\t\t\tlat = 90 - MathUtils.radToDeg( _spherical.phi );\n\t\t\tlon = MathUtils.radToDeg( _spherical.theta );\n\n\t\t}\n\n\t\tthis.handleResize();\n\n\t\tsetOrientation( this );\n\n\t}\n\n}\n\nfunction contextmenu( event ) {\n\n\tevent.preventDefault();\n\n}\n\nexport { FirstPersonControls };\n","import { useRef, useEffect } from \"react\"\n\nimport * as THREE from 'three'\nimport { MTLLoader } from 'three/addons/loaders/MTLLoader.js'\nimport { OBJLoader } from 'three/addons/loaders/OBJLoader.js'\nimport { FirstPersonControls } from 'three/addons/controls/FirstPersonControls.js'\n\nlet threeBox\n\nlet camera\nconst initCamera = () => {\n    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000)\n    camera.position.set(-100, 10, 50)\n}\n\nlet scene\nconst initScene = () => {\n    scene = new THREE.Scene()\n    scene.background = new THREE.CubeTextureLoader()\n\t.setPath( 'textures/cubeMaps/' )\n\t.load([\n\t\t'right.jpeg',\n\t\t'left.jpeg',\n\t\t'top.jpeg',\n\t\t'bottom.jpeg',\n\t\t'front.jpeg',\n\t\t'back.jpeg'\n\t])\n    // scene.background = new THREE.Color( 0xffffff )\n    // scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n}\n\nlet light\nconst initLight = () => {\n    light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n\tlight.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n}\n\nlet controls\nconst initControls = () => {\n    controls = new FirstPersonControls(camera, threeBox)\n    controls.lookSpeed = 0.1\n    controls.movementSpeed = 50\n    controls.lookVertical = false\n}\n\nlet renderer\nconst initRenderer = () => {\n    renderer = new THREE.WebGLRenderer({antialias:true})\n    renderer.setPixelRatio(window.devicePixelRatio)\n    renderer.setSize(window.innerWidth, window.innerHeight)\n    // 禁用渲染器的排序功能，取提高性能，舍渲染出错\n    renderer.sortObjects = false \n    threeBox.appendChild(renderer.domElement)\n}\n\nconst render = () => {\n    renderer.clear()\n    renderer.render( scene, camera )\n}\n\nlet clock = new THREE.Clock()\nconst animate = () => {\n    render()\n    controls.update(clock.getDelta())\n    requestAnimationFrame(animate)\n}\n\nconst onWindowResize = () => {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize(window.innerWidth, window.innerHeight)\n    render()\n}\n\nconst vertex = new THREE.Vector3()\nconst color = new THREE.Color()\nconst initModel = () => {\n    let mtlLoader = new MTLLoader()\n    mtlLoader.load('models/city.mtl', (material) => {\n        let objLoader = new OBJLoader()\n        objLoader.setMaterials(material)\n        objLoader.load('models/city.obj', (object) => {\n            object.position.y = -10\n            object.scale.set(10, 10, 10);\n            scene.add(object)\n        })\n    })\n\n    let floorGeometry = new THREE.PlaneGeometry( 5000, 5000, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n        vertex.fromBufferAttribute( position, i )\n        vertex.x += Math.random() * 20 - 10\n        vertex.y += Math.random() * 2\n        vertex.z += Math.random() * 20 - 10\n        position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed()\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n        color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n        colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n}\n\nconst draw = () => {\n    initScene()\n    initCamera()\n    initLight()\n    initControls()\n    initModel()\n    initRenderer()\n    animate()\n    window.onresize = onWindowResize\n}\n\nconst NewSpace = () => {\n    const threeBoxRef = useRef(null)\n    useEffect(() => {\n        threeBox = threeBoxRef.current\n        draw()\n        return () => {\n            threeBox.innerHTML = \"\"\n        }\n    }, [])\n    return <div ref={threeBoxRef}></div>\n}\n\nexport default NewSpace"],"names":["_lookDirection","Vector3","_spherical","Spherical","_target","FirstPersonControls","_createClass","object","domElement","_classCallCheck","this","enabled","movementSpeed","lookSpeed","lookVertical","autoForward","activeLook","heightSpeed","heightCoef","heightMin","heightMax","constrainVertical","verticalMin","verticalMax","Math","PI","mouseDragOn","autoSpeedFactor","pointerX","pointerY","moveForward","moveBackward","moveLeft","moveRight","viewHalfX","viewHalfY","lat","lon","handleResize","document","window","innerWidth","innerHeight","offsetWidth","offsetHeight","onPointerDown","event","focus","button","onPointerUp","onPointerMove","pageX","pageY","offsetLeft","offsetTop","onKeyDown","code","moveUp","moveDown","onKeyUp","lookAt","x","y","z","isVector3","copy","set","setOrientation","update","targetPosition","delta","heightDelta","MathUtils","position","actualMoveSpeed","translateZ","translateX","translateY","actualLookSpeed","verticalLookRatio","max","min","phi","theta","setFromSphericalCoords","add","dispose","removeEventListener","contextmenu","_onPointerDown","_onPointerMove","_onPointerUp","_onKeyDown","_onKeyUp","bind","controls","quaternion","applyQuaternion","setFromVector3","addEventListener","preventDefault","threeBox","camera","scene","light","renderer","render","clear","clock","THREE","animate","getDelta","requestAnimationFrame","onWindowResize","aspect","updateProjectionMatrix","setSize","vertex","color","draw","background","setPath","load","MTLLoader","material","objLoader","OBJLoader","setMaterials","scale","floorGeometry","rotateX","attributes","i","l","count","fromBufferAttribute","random","setXYZ","colorsFloor","toNonIndexed","setHSL","push","r","g","b","setAttribute","floorMaterial","vertexColors","floor","initModel","antialias","setPixelRatio","devicePixelRatio","sortObjects","appendChild","onresize","threeBoxRef","useRef","useEffect","current","innerHTML","_jsx","ref"],"sourceRoot":""}