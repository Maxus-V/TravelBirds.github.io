{"version":3,"file":"static/js/523.4a1829f6.chunk.js","mappings":"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","sources":["../node_modules/three/examples/jsm/controls/FirstPersonControls.js","pages/Demo/newSpace/index.js"],"sourcesContent":["import {\n\tMathUtils,\n\tSpherical,\n\tVector3\n} from 'three';\n\nconst _lookDirection = new Vector3();\nconst _spherical = new Spherical();\nconst _target = new Vector3();\n\nclass FirstPersonControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\n\t\tthis.movementSpeed = 1.0;\n\t\tthis.lookSpeed = 0.005;\n\n\t\tthis.lookVertical = true;\n\t\tthis.autoForward = false;\n\n\t\tthis.activeLook = true;\n\n\t\tthis.heightSpeed = false;\n\t\tthis.heightCoef = 1.0;\n\t\tthis.heightMin = 0.0;\n\t\tthis.heightMax = 1.0;\n\n\t\tthis.constrainVertical = false;\n\t\tthis.verticalMin = 0;\n\t\tthis.verticalMax = Math.PI;\n\n\t\tthis.mouseDragOn = false;\n\n\t\t// internals\n\n\t\tthis.autoSpeedFactor = 0.0;\n\n\t\tthis.pointerX = 0;\n\t\tthis.pointerY = 0;\n\n\t\tthis.moveForward = false;\n\t\tthis.moveBackward = false;\n\t\tthis.moveLeft = false;\n\t\tthis.moveRight = false;\n\n\t\tthis.viewHalfX = 0;\n\t\tthis.viewHalfY = 0;\n\n\t\t// private variables\n\n\t\tlet lat = 0;\n\t\tlet lon = 0;\n\n\t\t//\n\n\t\tthis.handleResize = function () {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.viewHalfX = window.innerWidth / 2;\n\t\t\t\tthis.viewHalfY = window.innerHeight / 2;\n\n\t\t\t} else {\n\n\t\t\t\tthis.viewHalfX = this.domElement.offsetWidth / 2;\n\t\t\t\tthis.viewHalfY = this.domElement.offsetHeight / 2;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onPointerDown = function ( event ) {\n\n\t\t\tif ( this.domElement !== document ) {\n\n\t\t\t\tthis.domElement.focus();\n\n\t\t\t}\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = true; break;\n\t\t\t\t\tcase 2: this.moveBackward = true; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = true;\n\n\t\t};\n\n\t\tthis.onPointerUp = function ( event ) {\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = false; break;\n\t\t\t\t\tcase 2: this.moveBackward = false; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = false;\n\n\t\t};\n\n\t\tthis.onPointerMove = function ( event ) {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.pointerX = event.pageX - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.viewHalfY;\n\n\t\t\t} else {\n\n\t\t\t\tthis.pointerX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.domElement.offsetTop - this.viewHalfY;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyDown = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = true; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = true; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = true; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = true; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = true; break;\n\t\t\t\tcase 'KeyF': this.moveDown = true; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyUp = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = false; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = false; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = false; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = false; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = false; break;\n\t\t\t\tcase 'KeyF': this.moveDown = false; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.lookAt = function ( x, y, z ) {\n\n\t\t\tif ( x.isVector3 ) {\n\n\t\t\t\t_target.copy( x );\n\n\t\t\t} else {\n\n\t\t\t\t_target.set( x, y, z );\n\n\t\t\t}\n\n\t\t\tthis.object.lookAt( _target );\n\n\t\t\tsetOrientation( this );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.update = function () {\n\n\t\t\tconst targetPosition = new Vector3();\n\n\t\t\treturn function update( delta ) {\n\n\t\t\t\tif ( this.enabled === false ) return;\n\n\t\t\t\tif ( this.heightSpeed ) {\n\n\t\t\t\t\tconst y = MathUtils.clamp( this.object.position.y, this.heightMin, this.heightMax );\n\t\t\t\t\tconst heightDelta = y - this.heightMin;\n\n\t\t\t\t\tthis.autoSpeedFactor = delta * ( heightDelta * this.heightCoef );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.autoSpeedFactor = 0.0;\n\n\t\t\t\t}\n\n\t\t\t\tconst actualMoveSpeed = delta * this.movementSpeed;\n\n\t\t\t\tif ( this.moveForward || ( this.autoForward && ! this.moveBackward ) ) this.object.translateZ( - ( actualMoveSpeed + this.autoSpeedFactor ) );\n\t\t\t\tif ( this.moveBackward ) this.object.translateZ( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveLeft ) this.object.translateX( - actualMoveSpeed );\n\t\t\t\tif ( this.moveRight ) this.object.translateX( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveUp ) this.object.translateY( actualMoveSpeed );\n\t\t\t\tif ( this.moveDown ) this.object.translateY( - actualMoveSpeed );\n\n\t\t\t\tlet actualLookSpeed = delta * this.lookSpeed;\n\n\t\t\t\tif ( ! this.activeLook ) {\n\n\t\t\t\t\tactualLookSpeed = 0;\n\n\t\t\t\t}\n\n\t\t\t\tlet verticalLookRatio = 1;\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tverticalLookRatio = Math.PI / ( this.verticalMax - this.verticalMin );\n\n\t\t\t\t}\n\n\t\t\t\tlon -= this.pointerX * actualLookSpeed;\n\t\t\t\tif ( this.lookVertical ) lat -= this.pointerY * actualLookSpeed * verticalLookRatio;\n\n\t\t\t\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\n\t\t\t\tlet phi = MathUtils.degToRad( 90 - lat );\n\t\t\t\tconst theta = MathUtils.degToRad( lon );\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tphi = MathUtils.mapLinear( phi, 0, Math.PI, this.verticalMin, this.verticalMax );\n\n\t\t\t\t}\n\n\t\t\t\tconst position = this.object.position;\n\n\t\t\t\ttargetPosition.setFromSphericalCoords( 1, phi, theta ).add( position );\n\n\t\t\t\tthis.object.lookAt( targetPosition );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu );\n\t\t\tthis.domElement.removeEventListener( 'pointerdown', _onPointerDown );\n\t\t\tthis.domElement.removeEventListener( 'pointermove', _onPointerMove );\n\t\t\tthis.domElement.removeEventListener( 'pointerup', _onPointerUp );\n\n\t\t\twindow.removeEventListener( 'keydown', _onKeyDown );\n\t\t\twindow.removeEventListener( 'keyup', _onKeyUp );\n\n\t\t};\n\n\t\tconst _onPointerMove = this.onPointerMove.bind( this );\n\t\tconst _onPointerDown = this.onPointerDown.bind( this );\n\t\tconst _onPointerUp = this.onPointerUp.bind( this );\n\t\tconst _onKeyDown = this.onKeyDown.bind( this );\n\t\tconst _onKeyUp = this.onKeyUp.bind( this );\n\n\t\tthis.domElement.addEventListener( 'contextmenu', contextmenu );\n\t\tthis.domElement.addEventListener( 'pointerdown', _onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointermove', _onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerup', _onPointerUp );\n\n\t\twindow.addEventListener( 'keydown', _onKeyDown );\n\t\twindow.addEventListener( 'keyup', _onKeyUp );\n\n\t\tfunction setOrientation( controls ) {\n\n\t\t\tconst quaternion = controls.object.quaternion;\n\n\t\t\t_lookDirection.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\t\t\t_spherical.setFromVector3( _lookDirection );\n\n\t\t\tlat = 90 - MathUtils.radToDeg( _spherical.phi );\n\t\t\tlon = MathUtils.radToDeg( _spherical.theta );\n\n\t\t}\n\n\t\tthis.handleResize();\n\n\t\tsetOrientation( this );\n\n\t}\n\n}\n\nfunction contextmenu( event ) {\n\n\tevent.preventDefault();\n\n}\n\nexport { FirstPersonControls };\n","import { useRef, useEffect } from \"react\"\n\nimport * as THREE from 'three'\nimport { MTLLoader } from 'three/addons/loaders/MTLLoader.js'\nimport { OBJLoader } from 'three/addons/loaders/OBJLoader.js'\nimport { FirstPersonControls } from 'three/addons/controls/FirstPersonControls.js'\n\nlet threeBox\n\nlet camera\nconst initCamera = () => {\n    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000)\n    camera.position.set(-100, 10, 50)\n}\n\nlet scene\nconst initScene = () => {\n    scene = new THREE.Scene()\n    scene.background = new THREE.CubeTextureLoader()\n\t.setPath( 'textures/cubeMaps/' )\n\t.load([\n\t\t'right.jpeg',\n\t\t'left.jpeg',\n\t\t'top.jpeg',\n\t\t'bottom.jpeg',\n\t\t'front.jpeg',\n\t\t'back.jpeg'\n\t])\n    // scene.background = new THREE.Color( 0xffffff )\n    // scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n}\n\nlet light\nconst initLight = () => {\n    light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n\tlight.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n}\n\nlet controls\nconst initControls = () => {\n    controls = new FirstPersonControls(camera, threeBox)\n    controls.lookSpeed = 0.1\n    controls.movementSpeed = 50\n    controls.lookVertical = false\n}\n\nlet renderer\nconst initRenderer = () => {\n    renderer = new THREE.WebGLRenderer({antialias:true})\n    renderer.setPixelRatio(window.devicePixelRatio)\n    renderer.setSize(window.innerWidth, window.innerHeight)\n    // 禁用渲染器的排序功能，取提高性能，舍渲染出错\n    renderer.sortObjects = false \n    threeBox.appendChild(renderer.domElement)\n}\n\nconst render = () => {\n    renderer.clear()\n    renderer.render( scene, camera )\n}\n\nlet clock = new THREE.Clock()\nconst animate = () => {\n    render()\n    controls.update(clock.getDelta())\n    requestAnimationFrame(animate)\n}\n\nconst onWindowResize = () => {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize(window.innerWidth, window.innerHeight)\n    render()\n}\n\nconst vertex = new THREE.Vector3()\nconst color = new THREE.Color()\nconst initModel = () => {\n    let mtlLoader = new MTLLoader()\n    mtlLoader.load('models/city.mtl', (material) => {\n        let objLoader = new OBJLoader()\n        objLoader.setMaterials(material)\n        objLoader.load('models/city.obj', (object) => {\n            object.position.y = -10\n            object.scale.set(10, 10, 10);\n            scene.add(object)\n        })\n    })\n\n    let floorGeometry = new THREE.PlaneGeometry( 5000, 5000, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n        vertex.fromBufferAttribute( position, i )\n        vertex.x += Math.random() * 20 - 10\n        vertex.y += Math.random() * 2\n        vertex.z += Math.random() * 20 - 10\n        position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed()\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n        color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n        colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n}\n\nconst draw = () => {\n    initScene()\n    initCamera()\n    initLight()\n    initControls()\n    initModel()\n    initRenderer()\n    animate()\n    window.onresize = onWindowResize\n}\n\nconst NewSpace = () => {\n    const threeBoxRef = useRef(null)\n    useEffect(() => {\n        threeBox = threeBoxRef.current\n        draw()\n        return () => {\n            threeBox.innerHTML = \"\"\n        }\n    }, [])\n    return <div ref={threeBoxRef}></div>\n}\n\nexport default NewSpace"],"names":["_lookDirection","Vector3","_spherical","Spherical","_target","FirstPersonControls","_createClass","object","domElement","_classCallCheck","this","enabled","movementSpeed","lookSpeed","lookVertical","autoForward","activeLook","heightSpeed","heightCoef","heightMin","heightMax","constrainVertical","verticalMin","verticalMax","Math","PI","mouseDragOn","autoSpeedFactor","pointerX","pointerY","moveForward","moveBackward","moveLeft","moveRight","viewHalfX","targetPosition","lat","viewHalfY","lon","_onPointerMove","handleResize","document","window","innerWidth","innerHeight","offsetWidth","offsetHeight","onPointerDown","event","focus","button","onPointerUp","onPointerMove","pageX","pageY","offsetLeft","offsetTop","onKeyDown","code","moveUp","moveDown","onKeyUp","lookAt","x","y","z","isVector3","copy","set","setOrientation","update","delta","phi","position","heightDelta","MathUtils","actualMoveSpeed","translateZ","translateX","translateY","actualLookSpeed","verticalLookRatio","max","min","theta","setFromSphericalCoords","add","dispose","removeEventListener","contextmenu","_onPointerDown","_onPointerUp","_onKeyDown","_onKeyUp","bind","controls","quaternion","applyQuaternion","setFromVector3","addEventListener","preventDefault","render","renderer","clear","scene","camera","threeBox","light","clock","THREE","animate","getDelta","requestAnimationFrame","onWindowResize","aspect","updateProjectionMatrix","setSize","vertex","color","threeBoxRef","useRef","useEffect","current","background","setPath","load","MTLLoader","material","objLoader","OBJLoader","setMaterials","scale","floorGeometry","rotateX","attributes","i","l","count","fromBufferAttribute","random","setXYZ","colorsFloor","toNonIndexed","setHSL","push","r","g","b","setAttribute","floorMaterial","vertexColors","floor","initModel","antialias","setPixelRatio","devicePixelRatio","sortObjects","appendChild","onresize","innerHTML","_jsx","ref"],"sourceRoot":""}